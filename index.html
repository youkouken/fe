<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FE Quest (Offline)</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="toast" id="toast">Ready</div>

    <div class="modal-overlay" id="mode-modal">
        <div class="modal-box">
            <div class="modal-title" id="lbl-mode-title"></div>
            <button class="mode-btn" id="btn-mode-10" onclick="confirmStart(10)"></button>
            <button class="mode-btn" id="btn-mode-20" onclick="confirmStart(20)"></button>
            <button class="mode-btn" id="btn-mode-30" onclick="confirmStart(30)"></button>
            <button class="mode-btn secondary" id="btn-mode-all" onclick="confirmStart('all')"></button>
            <div style="margin-top:15px; color:#aaa; cursor:pointer;" id="lbl-cancel" onclick="closeModal()"></div>
        </div>
    </div>

    <div class="modal-overlay" id="msg-modal" onclick="closePopup()">
        <div class="modal-box" onclick="event.stopPropagation()">
            <div class="modal-title" id="msg-content" style="margin-bottom: 20px; line-height: 1.5;"></div>
            <button class="mode-btn" id="btn-msg-ok" onclick="closePopup()"></button>
        </div>
    </div>

    <div id="lobby-screen" class="screen" style="display: flex;">
        
        <div class="header-capsule">
            <div class="user-trigger" style="cursor: default;">
                <div id="guest-avatar" class="avatar-placeholder">üë§</div>
            </div>
            
            <div style="flex:1;"></div> 

            <button class="header-action-btn" onclick="toggleTheme()">üé®</button>
        </div>

        <div class="content-area">
            <h2 id="lbl-app-title" style="text-align:center; color:var(--text-color); opacity:0.8; margin-bottom:20px;"></h2>
            <div class="chapter-list" id="chapter-list"></div>
        </div>

        <div class="footer-stats">
            <button class="stat-pill" onclick="startBookmarkSession()">
                <span style="color:#f1c40f;">‚òÖ</span> 
                <span id="bookmark-count" style="margin-left:5px;">0</span>
            </button>
            
            <button class="stat-pill" onclick="showMasteredScreen()">
                <span style="color:#e67e22;">üèÜ</span> 
                <span id="mastered-count" style="margin-left:5px;">0</span>
            </button>
        </div>
        
        <div style="text-align: center; margin-bottom: 10px;">
             <button id="btn-reset" onclick="resetProgress()" style="background:none; border:none; color:var(--text-color); opacity:0.3; font-size:0.8rem;">Reset</button>
        </div>
    </div>

    <div id="study-screen" class="screen">
        <div class="top-bar">
            <button class="icon-btn" onclick="goBackToLobby()">‚úï</button>
            <div class="progress-pill">
                <span id="lbl-remain"></span> <span id="remain-count">0</span>
            </div>
        </div>
        
        <div class="card-area">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="card-face card-front">
                    <div class="card-icon" id="bookmark-icon" onclick="toggleBookmark(event)">‚òÖ</div>
                    <div class="status-dot" id="debt-badge"></div>
                    
                    <div class="term-main" id="term-zh">---</div>
                    <div class="divider-line"></div>
                    <div class="term-sub" id="term-ja">---</div>
                    <div class="term-eng" id="term-eng">---</div>
                    <div class="tap-hint" id="lbl-tap">Tap</div>
                </div>
                <div class="card-face card-back">
                    <div class="desc-text" id="desc-zh">---</div>
                    <div class="divider-line"></div>
                    <div class="desc-text" id="desc-ja">---</div>
                </div>
            </div>
        </div>

        <div class="action-bar">
            <button class="action-btn fuzzy" id="btn-fuzzy" onclick="handleBlurry()">üòµ</button>
            <button class="action-btn know" id="btn-know" onclick="handleKnow()">ü§î</button>
            <button class="action-btn master" id="btn-master" onclick="handleMastered()">üòé</button>
        </div>
    </div>

    <div id="mastered-screen" class="screen">
        <div class="top-bar">
            <button class="icon-btn" onclick="goBackToLobby()">‚óÄ</button>
            <span style="font-weight:bold; color:var(--text-color);" id="lbl-list-title"></span>
        </div>
        <div class="chapter-list" id="mastered-list" style="padding-top:20px;"></div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>